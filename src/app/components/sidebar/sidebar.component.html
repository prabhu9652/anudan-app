<div class="sidebar-wrapper h-100">
    <ul class="nav h-100">
        <li *ngIf="isMobileMenu()" class="p-1 nav-item">

            <ng-container *ngIf="appComponent.notifications.length > 0">
                <div (click)="showMessages()" style="position:relative; float:right;">
                <mat-icon class="float-right mr-3 mt-3" [matBadge]="this.appComponent.notifications.length" matBadgeColor="warn">notifications</mat-icon>
                </div>
            </ng-container>
            <ng-container *ngIf="appComponent.notifications.length === 0">
                <mat-icon class="float-right mr-3 mt-3" (click)="showMessages()">notifications_none</mat-icon>
            </ng-container>
            <img [src]="appComponent.appConfig.logoUrl" alt="logo" class="w-25 float-left">
            <a class="nav-link" (click)="showProfile()">
                <p class="text-white font-weight-bolder">{{appComponent.loggedInUser.lastName}}
                    , {{appComponent.loggedInUser.firstName}}</p>
                <ng-container *ngFor="let userRole of appComponent.loggedInUser.userRoles; let i = index">
                    <span class="text-white">{{userRole.role.name}}
                        <ng-container *ngIf="i!=appComponent.loggedInUser.userRoles.length-1">, </ng-container></span>
                </ng-container>
            </a>

        </li>

        <ng-container *ngIf="appComponent.currentView === 'grants' || appComponent.currentView === 'organization' || appComponent.currentView === 'rfps' || appComponent.currentView === 'applications'">
            <ng-container *ngFor="let menuItem of menuItems">
            <li routerLinkActive="active" *ngIf="menuItem.title !=='Organization'"
                class="{{menuItem.class}} nav-item text-left">
                <a class="nav-link" [routerLink]="[menuItem.path]">
                    <i class="material-icons">{{menuItem.icon}}</i>
                    <p><b>{{menuItem.title}}</b></p>
                </a>
            </li>
                <mat-expansion-panel *ngIf="menuItem.title === 'Organization'">
                    <mat-expansion-panel-header (click)="buildSectionsSideNav()" style="padding: 15px;">
                        <mat-panel-title style="display: flex; align-items: center">
                            <i class="material-icons">account_balance</i>Organization
                        </mat-panel-title>
                    </mat-expansion-panel-header>
                    <li routerLinkActive="active" *ngFor="let orgMenuItem of orgMenuItems"
                        class="{{orgMenuItem.class}} nav-item text-left">
                        <a class="nav-link py-0" [routerLink]="[orgMenuItem.path]">
                            <i class="material-icons" style="font-size:18px;">{{orgMenuItem.icon}}</i>
                            <p>{{orgMenuItem.title}}</p>
                        </a>
                    </li>
                </mat-expansion-panel>
            </ng-container>



            <!--<mat-expansion-panel *ngIf="appComponent.loggedInUser.permissions.includes('Manage Workflows')">
                <mat-expansion-panel-header (click)="buildSectionsSideNav()" style="padding: 15px;">
                  <mat-panel-title style="display: flex; align-items: center">
                    <i class="material-icons">build</i>Administration
                  </mat-panel-title>
                </mat-expansion-panel-header>
                <li routerLinkActive="active" *ngFor="let adminMenuItem of adminMenuItems"
                class="{{adminMenuItem.class}} nav-item text-left">
                <a class="nav-link" [routerLink]="[adminMenuItem.path]">
                    <i class="material-icons">{{adminMenuItem.icon}}</i>
                    <p>{{adminMenuItem.title}}</p>
                </a>
            </li>
            </mat-expansion-panel>-->
            

        </ng-container>
         
        
        <ng-container *ngIf="appComponent.currentView === 'grant'">
            <li routerLinkActive="active" *ngFor="let menuItem of grantMenuItems"
                class="{{menuItem.class}} nav-item text-left">
                <ng-container *ngIf="menuItem.title !== 'Grant Details' && menuItem.title !== 'Monitoring & Evaluation'">
                    <a class="nav-link" [routerLink]="[menuItem.path]" *ngIf="(currentGrant.grantStatus.internalStatus!='ACTIVE' && currentGrant.grantStatus.internalStatus!='CLOSED')">
                        <i class="material-icons">{{menuItem.icon}}</i>
                        <p style="font-size: 15px;"><b>{{menuItem.title}}</b></p>
                    </a>
                    <a class="nav-link" [routerLink]="[menuItem.path]" *ngIf="(currentGrant.grantStatus.internalStatus=='ACTIVE' || currentGrant.grantStatus.internalStatus=='CLOSED')  && menuItem.title=='Preview & Submit'">
                        <i class="material-icons">{{menuItem.icon}}</i>
                        <p style="font-size: 15px;"><b>Preview</b></p>
                    </a>
                </ng-container>
            
                <ng-container *ngIf="menuItem.title === 'Grant Details' && (currentGrant.grantStatus.internalStatus!='ACTIVE' && currentGrant.grantStatus.internalStatus!='CLOSED')">
                    <mat-expansion-panel cdkDropList (cdkDropListDropped)="drop($event)">
                        <mat-expansion-panel-header (click)="buildSectionsSideNav()" style="padding: 15px;">
                          <mat-panel-title style="display: flex; align-items: center">
                            <i class="material-icons">list</i>Grant Details
                          </mat-panel-title>
                        </mat-expansion-panel-header>
                        <li cdkDrag (cdkDragStarted)="dragStarted($event)" routerLinkActive="active" *ngFor="let menuItem1 of sectionMenuItems" class="{{menuItem1.class}} nav-item text-left" style="cursor:move">
                            <i *ngIf="false" cdkDragHandle class="material-icons" style="margin:0px 14px 0px 20px">drag_indicator</i>
                            <p *cdkDragPreview style="color:#fff;">{{menuItem1.title}}</p>
                            <a class="nav-link  py-0" [routerLink]="[menuItem1.path]" style="padding-top: 0;padding-bottom: 0;padding-left:30px;">

                                <i *ngIf="!currentGrant.actionAuthorities.permissions.includes('MANAGE')" class="material-icons" style="font-size:18px;">{{menuItem1.icon}}</i>
                                <p>{{menuItem1.title}}</p>
                            </a>
                    </li>
                    <li routerLinkActive="active" *ngFor="let menuItem of grantMenuItems"
                class="{{menuItem.class}} nav-item text-left">
                    <ng-container *ngIf="menuItem.title === 'Monitoring & Evaluation'">
                        <a class="nav-link" [routerLink]="[menuItem.path]" style="padding-top: 0;padding-bottom: 0;">
                            <i class="material-icons">{{menuItem.icon}}</i>
                            <p>{{menuItem.title}}</p>
                        </a>
                    </ng-container>
                </li>
                    </mat-expansion-panel>
                </ng-container>
            </li>
        </ng-container>

        <li class="nav-item" *ngIf="appComponent.loggedInUser && isMobileMenu()">
            <a class="nav-link text-left" (click)="appComponent.logout()">
                <i class="material-icons">exit_to_app</i>
                <p>Logout</p>
            </a>
        </li>

    </ul>
    <hr>
</div>


